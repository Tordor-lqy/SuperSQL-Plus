import{_ as j,D as B,r as n,B as O,c as l,a as i,t as c,M as D,w as o,v as r,E as f,G as v,F as S,h as V,b as g,P as I,H as L,I as N,Q as A,o as d,p as C,e as J,R as M}from"./index-DyMfYp_t.js";import{g as u}from"./base64-BbY-I90a.js";const _=h=>(C("data-v-f4013c58"),h=h(),J(),h),G={style:{height:"100%",width:"100%",overflow:"hidden"}},F={style:{height:"105%",width:"105%",overflow:"scroll"}},R={style:{"margin-bottom":"20px"}},$={class:"item"},z={class:"input-group"},H=_(()=>i("label",{for:"api_uri"},"链接",-1)),Q={class:"input-group"},K=_(()=>i("label",{for:"api_method"},"方法",-1)),W=_(()=>i("option",{value:"GET"},"GET",-1)),X=_(()=>i("option",{value:"POST"},"POST",-1)),Y=_(()=>i("option",{value:"PUT"},"PUT",-1)),Z=_(()=>i("option",{value:"DELETE"},"DELETE",-1)),ii=[W,X,Y,Z],ai={class:"input-group"},ei=_(()=>i("label",{for:"api_method"},"名称",-1)),si={class:"input-group"},ti=_(()=>i("label",{for:"api_on"},"启用",-1)),_i={class:"switch"},oi=_(()=>i("span",{class:"slider"},null,-1)),pi={class:"input-group"},ui=_(()=>i("label",{for:"api_is_use_auth"},"启用鉴权",-1)),li={class:"switch"},di=_(()=>i("span",{class:"slider"},null,-1)),ni={key:0,class:"input-group"},ri=_(()=>i("label",{for:"api_auth_id"},"鉴权组",-1)),ci=["value"],vi={class:"input-group"},hi=_(()=>i("label",{for:"api_query"},"query参数",-1)),bi={class:"input-group"},mi=_(()=>i("label",{for:"api_is_use_body"},"启用body参数",-1)),yi={class:"switch"},fi=_(()=>i("span",{class:"slider"},null,-1)),gi={class:"input-group"},wi=_(()=>i("label",{for:"api_is_use_script"},"启用前置脚本",-1)),xi={class:"switch"},qi=_(()=>i("span",{class:"slider"},null,-1)),Ui={key:1,class:"input-group"},Si=_(()=>i("label",{for:"api_script"},"脚本",-1)),Vi={class:"input-group"},ki=_(()=>i("label",{for:"api_db_id"},"数据库",-1)),Ei=["value"],Ti={class:"input-group"},Pi=_(()=>i("label",{for:"api_sql"},"sql语句",-1)),ji={class:"input-group"},Bi=_(()=>i("label",{for:"api_is_use_post_script"},"启用后置脚本",-1)),Oi={class:"switch"},Di=_(()=>i("span",{class:"slider"},null,-1)),Ii={key:2,class:"input-group"},Li=_(()=>i("label",{for:"api_post_script"},"后置脚本",-1)),Ni={__name:"ProjectAPI",setup(h){const m=B(),b=n(m.params.api_id),e=n({}),a=n({}),w=async()=>{const p=await I(b.value);e.value=p.data.data,a.value={api_config_id:e.value.api_config_id,api_name:e.value.api_name,api_uri:e.value.api_uri,api_method:e.value.api_method,api_db_id:e.value.api_db_id,api_project_id:e.value.api_project_id,api_sql:e.value.api_sql,api_query:u.decode(e.value.api_query),api_is_use_body:e.value.api_is_use_body==1,api_script:JSON.parse(u.decode(e.value.api_script)),api_is_use_script:e.value.api_is_use_script==1,api_on:e.value.api_on==1,api_post_script:JSON.parse(u.decode(e.value.api_post_script)),api_is_use_post_script:e.value.api_is_use_post_script==1,api_auth_id:e.value.api_auth_id,api_is_use_auth:e.value.api_is_use_auth==1}};w();const x=n([]),q=async()=>{const p=await L();x.value=p.data.data};q();const U=n([]);(async()=>{const p=await N();U.value=p.data.data})();const y=n({}),k=async()=>{y.value={api_config_id:a.value.api_config_id,api_name:a.value.api_name,api_uri:a.value.api_uri,api_method:a.value.api_method,api_db_id:a.value.api_db_id,api_project_id:a.value.api_project_id,api_sql:a.value.api_sql,api_query:u.encode(a.value.api_query),api_is_use_body:a.value.api_is_use_body?1:0,api_script:u.encode(JSON.stringify(a.value.api_script)),api_is_use_script:a.value.api_is_use_script?1:0,api_on:a.value.api_on?1:0,api_post_script:u.encode(JSON.stringify(a.value.api_post_script)),api_is_use_post_script:a.value.api_is_use_post_script?1:0,api_auth_id:a.value.api_auth_id,api_is_use_auth:a.value.api_is_use_auth?1:0};const p=await M(y.value.api_config_id,y.value);e.value=p.data.data,a.value={api_config_id:e.value.api_config_id,api_name:e.value.api_name,api_uri:e.value.api_uri,api_method:e.value.api_method,api_db_id:e.value.api_db_id,api_project_id:e.value.api_project_id,api_sql:e.value.api_sql,api_query:u.decode(e.value.api_query),api_is_use_body:e.value.api_is_use_body==1,api_script:JSON.parse(u.decode(e.value.api_script)),api_is_use_script:e.value.api_is_use_script==1,api_on:e.value.api_on==1,api_post_script:JSON.parse(u.decode(e.value.api_post_script)),api_is_use_post_script:e.value.api_is_use_post_script==1,api_auth_id:e.value.api_auth_id,api_is_use_auth:e.value.api_is_use_auth==1},window.location.reload()},E=async()=>{await A(b.value),window.location.href=`/#/project/${m.params.id}`};O(m,p=>{p.params.api_id!==b.value&&(b.value=p.params.api_id,w(),q())});const T=p=>{switch(p){case"GET":return"green";case"POST":return"orange";case"PUT":return"blue";case"DELETE":return"red";default:return"gray"}},P=()=>{k()};return n({}),(p,t)=>(d(),l("div",G,[i("div",F,[i("div",R,c(a.value.api_name),1),i("div",$,[i("div",{style:D({backgroundColor:T(a.value.api_method),padding:"3px",borderRadius:"3px",height:"18px",lineHeight:"18px",color:"white",fontSize:"13px"})},c(a.value.api_method),5),i("div",null,c(a.value.api_uri),1)]),i("div",z,[H,o(i("input",{type:"text",id:"api_uri","onUpdate:modelValue":t[0]||(t[0]=s=>a.value.api_uri=s)},null,512),[[r,a.value.api_uri]])]),i("div",Q,[K,o(i("select",{id:"api_method","onUpdate:modelValue":t[1]||(t[1]=s=>a.value.api_method=s)},ii,512),[[f,a.value.api_method]])]),i("div",ai,[ei,o(i("input",{type:"text",id:"api_method","onUpdate:modelValue":t[2]||(t[2]=s=>a.value.api_name=s)},null,512),[[r,a.value.api_name]])]),i("div",si,[ti,i("label",_i,[o(i("input",{type:"checkbox",id:"api_on","onUpdate:modelValue":t[3]||(t[3]=s=>a.value.api_on=s)},null,512),[[v,a.value.api_on]]),oi])]),i("div",pi,[ui,i("label",li,[o(i("input",{type:"checkbox",id:"api_is_use_auth","onUpdate:modelValue":t[4]||(t[4]=s=>a.value.api_is_use_auth=s)},null,512),[[v,a.value.api_is_use_auth]]),di])]),a.value.api_is_use_auth?(d(),l("div",ni,[ri,o(i("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.value.api_auth_id=s)},[(d(!0),l(S,null,V(U.value,s=>(d(),l("option",{value:s.authentication_id},c(s.authentication_name),9,ci))),256))],512),[[f,a.value.api_auth_id]])])):g("",!0),i("div",vi,[hi,o(i("textarea",{id:"api_query","onUpdate:modelValue":t[6]||(t[6]=s=>a.value.api_query=s),rows:"4"},null,512),[[r,a.value.api_query]])]),i("div",bi,[mi,i("label",yi,[o(i("input",{type:"checkbox",id:"api_is_use_body","onUpdate:modelValue":t[7]||(t[7]=s=>a.value.api_is_use_body=s)},null,512),[[v,a.value.api_is_use_body]]),fi])]),i("div",gi,[wi,i("label",xi,[o(i("input",{type:"checkbox",id:"api_is_use_script","onUpdate:modelValue":t[8]||(t[8]=s=>a.value.api_is_use_script=s)},null,512),[[v,a.value.api_is_use_script]]),qi])]),a.value.api_is_use_script?(d(),l("div",Ui,[Si,o(i("textarea",{id:"api_script","onUpdate:modelValue":t[9]||(t[9]=s=>a.value.api_script=s),rows:"4"},null,512),[[r,a.value.api_script]])])):g("",!0),i("div",Vi,[ki,o(i("select",{"onUpdate:modelValue":t[10]||(t[10]=s=>a.value.api_db_id=s)},[(d(!0),l(S,null,V(x.value,s=>(d(),l("option",{value:s.db_id},c(`${s.db_name}@${s.db_host}`),9,Ei))),256))],512),[[f,a.value.api_db_id]])]),i("div",Ti,[Pi,o(i("textarea",{id:"api_sql","onUpdate:modelValue":t[11]||(t[11]=s=>a.value.api_sql=s),rows:"4"},null,512),[[r,a.value.api_sql]])]),i("div",ji,[Bi,i("label",Oi,[o(i("input",{type:"checkbox",id:"api_is_use_post_script","onUpdate:modelValue":t[12]||(t[12]=s=>a.value.api_is_use_post_script=s)},null,512),[[v,a.value.api_is_use_post_script]]),Di])]),a.value.api_is_use_post_script?(d(),l("div",Ii,[Li,o(i("textarea",{id:"api_post_script","onUpdate:modelValue":t[13]||(t[13]=s=>a.value.api_post_script=s),rows:"4"},null,512),[[r,a.value.api_post_script]])])):g("",!0),i("div",{class:"form-buttons",style:{display:"flex",width:"60%",margin:"0 auto","margin-bottom":"20px","justify-content":"space-between"}},[i("button",{type:"submit",class:"submit-button",onClick:P}," Submit "),i("button",{type:"botton",class:"submit-button",onClick:E}," Delete ")])])]))}},Mi=j(Ni,[["__scopeId","data-v-f4013c58"]]);export{Mi as default};
